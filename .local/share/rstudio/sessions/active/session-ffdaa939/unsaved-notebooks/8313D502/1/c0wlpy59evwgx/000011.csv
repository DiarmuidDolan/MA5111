"0","volcano_plot_combined <- function(up_df, down_df, threshold = 0.05, log2FC = 1) {"
"0","  up <- up_df[up_df$log2FoldChange > log2FC & up_df$pvalue < threshold, ]"
"0","  down <- down_df[down_df$log2FoldChange < -log2FC & down_df$pvalue < threshold, ]"
"0","  "
"0","  plot(c(up_df$log2FoldChange, down_df$log2FoldChange), "
"0","       c(-log10(up_df$pvalue), -log10(down_df$pvalue)), "
"0","       col=""grey"", xlab=""log2 Fold Change"", ylab=""-log10 p-value"", main=""Volcano Plot"")"
"0","  "
"0","  points(up$log2FoldChange, -log10(up$pvalue), col=""red"", pch=16)"
"0","  points(down$log2FoldChange, -log10(down$pvalue), col=""blue"", pch=16)"
"0","  "
"0","  legend(""topright"", legend=c(""Upregulated"", ""Downregulated""), "
"0","         col=c(""red"", ""blue""), pch=16)"
"0","}"
"0",""
"0","volcano_plot_combined(upregulated_genes, downregulated_genes)"
"0",""
